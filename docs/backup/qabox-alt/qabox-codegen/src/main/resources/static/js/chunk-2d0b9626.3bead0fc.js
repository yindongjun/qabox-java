(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b9626"],{"335e":function(e,a,r){"use strict";r.r(a);var t=function(){var e=this,a=e.$createElement,r=e._self._c||a;return r("standard-drawer",{ref:"standardDrawer",attrs:{title:e.readOnly?"详情":e.form.id?"用户编辑":"新增操作",confirmLoading:e.confirmLoading,editable:!e.readOnly},on:{close:e.close,confirm:e.confirm}},[r("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[r("a-form-model-item",{ref:"username",attrs:{label:"用户名",prop:"username"}},[r("a-input",{attrs:{disabled:!e.readOnly&&"undefined"!==typeof e.form.id,placeholder:"请输入菜单名称"},model:{value:e.form.username,callback:function(a){e.$set(e.form,"username",a)},expression:"form.username"}})],1),r("a-form-model-item",{attrs:{label:"昵称",prop:"nickname"}},[r("a-input",{attrs:{placeholder:"请输入昵称或真实姓名"},model:{value:e.form.nickname,callback:function(a){e.$set(e.form,"nickname",a)},expression:"form.nickname"}})],1),r("a-form-model-item",{attrs:{label:"邮箱地址",prop:"email"}},[r("a-auto-complete",{attrs:{"data-source":e.emailDataSource,placeholder:"请输入邮箱地址"},on:{change:e.handleEmailChange},model:{value:e.form.email,callback:function(a){e.$set(e.form,"email",a)},expression:"form.email"}})],1),r("a-form-model-item",{attrs:{label:"手机号",prop:"mobile"}},[r("a-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.form.mobile,callback:function(a){e.$set(e.form,"mobile",a)},expression:"form.mobile"}})],1),r("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[r("a-radio-group",{model:{value:e.form.status,callback:function(a){e.$set(e.form,"status",a)},expression:"form.status"}},e._l(e.userStatus,(function(a){return r("a-radio-button",{key:a.value,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"角色分配",prop:"description"}},[r("a-select",{attrs:{mode:"multiple",placeholder:"请选择角色",allowClear:""},model:{value:e.form.roleIds,callback:function(a){e.$set(e.form,"roleIds",a)},expression:"form.roleIds"}},e._l(e.allRoles,(function(a){return r("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"独立权限",prop:"resourceIds"}},[r("a-tree",{staticStyle:{width:"100%"},attrs:{checkable:"","auto-expand-parent":!0,"default-expand-all":!0,multiple:!0,"check-strictly":!0,"default-expanded-keys":e.defaultExpandedKeys,"tree-data":e.treeData,replaceFields:{title:"name",key:"id",value:"id"}},model:{value:e.form.resourceIds,callback:function(a){e.$set(e.form,"resourceIds",a)},expression:"form.resourceIds"}})],1)],1)],1)},o=[],s=(r("c975"),r("4d63"),r("ac1f"),r("25f0"),r("b775")),l=r("2af9"),n={name:"UserEditPanel",components:{StandardDrawer:l["h"],IconSelector:l["d"]},data:function(){return{userStatus:this.$dic.query("sys_user_state"),emailDataSource:[],confirmLoading:!1,defaultExpandedKeys:[],treeData:[],readOnly:!1,labelCol:{span:4},wrapperCol:{span:18},form:{username:"",nickname:"",resourceIds:[],status:void 0,roleIds:[]},rules:{username:[{required:!0,message:"此项为必输项",trigger:"blur"},{max:20,message:"最多输入20个字符",trigger:"change"}],nickname:[{required:!0,message:"此项为必输项",trigger:"blur"},{max:50,message:"最多输入50个字符",trigger:"change"}],status:[{required:!0,message:"此项为必选项",trigger:"change"}],mobile:[{pattern:new RegExp("^[1][3-8][0-9]{9}$"),message:"格式不合法",trigger:"change"}],email:[{type:"email",message:"格式不合法",trigger:"change"}]}}},computed:{allRoles:function(){return this.$store.getters.allRoles}},methods:{show:function(e,a){e&&(this.form=Object.assign({},e)||{}),this.readOnly="undefined"!==typeof a&&!0===a,this.defaultExpandedKeys=this.form.resourceIds,this.loadMenuTree(),this.$refs.standardDrawer.show()},confirm:function(){var e=this;this.confirmLoading=!0,this.$refs.ruleForm.validate((function(a){var r=Object.assign({},e.form);if(r.resourceIds instanceof Array||!r.resourceIds.checked||(r.resourceIds=r.resourceIds.checked),!a)return e.confirmLoading=!1;(e.form.id?e.$http.put:e.$http.post)("user",r).then((function(a){e.$message.success("操作成功！"),e.$emit("handle-success"),e.$refs.standardDrawer.close()})).catch((function(a){e.confirmLoading=!1}))}))},close:function(){this.form={name:"",resourceIds:[],nickname:"",status:void 0,roleIds:[]},this.confirmLoading=!1,this.$refs.ruleForm.resetFields()},loadMenuTree:function(){var e=this;Object(s["b"])({url:"resource/tree?status=1",method:"get"}).then((function(a){e.treeData=a.data||[]}))},handleEmailChange:function(e){this.emailDataSource=!e||e.indexOf("@")>=0?[]:["".concat(e,"@gmail.com"),"".concat(e,"@163.com"),"".concat(e,"@qq.com")]}}},i=n,c=r("2877"),m=Object(c["a"])(i,t,o,!1,null,"18598f1a",null);a["default"]=m.exports}}]);